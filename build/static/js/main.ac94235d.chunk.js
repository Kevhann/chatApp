(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{108:function(e,t,n){},109:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(9),c=n.n(a),l=n(14),s=n(57),u=n.n(s),i=n(7),E=function(){return Date().substring(16,24)},m=function(){return console.log("generated"),"hsl("+360*Math.random()+",100%,50%)"},g=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return"".concat(e()).concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())},f=function(e){var t=e.message;switch(t.type){case"AUTOMATED_MESSAGE":return o.a.createElement("div",{className:"messageElement"},o.a.createElement("span",{style:{color:t.color}},"<".concat(t.time," ").concat(t.user," ").concat(t.content,">")));case"PRIVATE_MESSAGE":return o.a.createElement("div",{className:"messageElement"},o.a.createElement("span",{style:{color:t.color}},"<".concat(t.time," Whisper from ").concat(t.user,">")),o.a.createElement("span",{className:"message-content"},t.content));default:return o.a.createElement("div",{className:"messageElement"},o.a.createElement("span",{style:{color:t.color}},"<".concat(t.time," ").concat(t.user,">")),o.a.createElement("span",{className:"message-content"},t.content))}},O=Object(i.b)((function(e){return{messageLog:e.messageLogReducer}}))((function(e){var t=e.messageLog;return Object(r.useEffect)((function(){var e=document.getElementById("messageLog");e.scrollTop=e.scrollHeight}),[t]),o.a.createElement("ul",{className:"messageLog",id:"messageLog"},t.map((function(e){return o.a.createElement(f,{key:g(),message:e})})))})),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":return t.value;default:return e}},d=function(e){return{type:"ADD_MESSAGE_TO_LOG",value:e}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE_LOG":return t.value;case"ADD_MESSAGE_TO_LOG":return e.concat(t.value);default:return e}},h=n(116),v={setMessage:function(e){return{type:"SET_MESSAGE",value:e}},addMessageToLog:d},b=Object(i.b)((function(e){return{message:e.messageReducer,socket:e.socketReducer,user:e.userReducer}}),v)((function(e){var t=e.user,n=e.socket,r=e.message,a=e.setMessage,c=e.addMessageToLog;return o.a.createElement(h.a,{onSubmit:function(e){return function(e){if(e.preventDefault(),r){var o=E();console.log("user:",t),console.log("message:",r);var l={content:r,time:o,user:t.name,color:t.color};c(l),n.emit("SENT_MESSAGE",l),a("")}}(e)},className:"messagePrompt"},o.a.createElement(h.a.Group,null,o.a.createElement(h.a.Control,{type:"text",placeholder:"Send message",value:r,onChange:function(e){return function(e){a(e.target.value)}(e)}})))})),y=n(64),T=n(115),_=n(60),R=n(111),j=n(112);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.value;case"SET_USER_NAME":return w({},e,{name:t.value});default:return e}};function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e,t){return{type:"SET_SHOW_ALERT",show:e,text:t}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{showLogin:!0,showAlert:!1,alertText:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SHOW_ALERT":return D({},e,{showAlert:t.show,alertText:t.text});case"SET_SHOW_LOGIN":return D({},e,{showLogin:t.value});default:return e}},M={setUserName:function(e){return{type:"SET_USER_NAME",value:e}},setShowAlert:N},C=Object(i.b)((function(e){return{socket:e.socketReducer,login:e.loginReducer,user:e.userReducer}}),M)((function(e){var t=e.socket,n=e.login,a=e.user,c=e.setUserName,l=e.setShowAlert,s=Object(r.useState)(null),u=Object(y.a)(s,2),i=u[0],g=u[1];Object(r.useEffect)((function(){g(m())}),[]);var f=function(e){if(e.preventDefault(),a.name.length<3)l(!0,"Name must be at least 3 characters");else if(a.name.length>15)l(!0,"Name must be less than 16 characters");else if(-1===a.name.indexOf(" ")){var n={time:E(),user:a.name,color:i};t.emit("SET_NAME_TAG",n)}else l(!0,"No whitespace allowed")};return o.a.createElement(T.a,{show:n.showLogin,size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0},o.a.createElement(T.a.Header,null,o.a.createElement(T.a.Title,{id:"contained-modal-title-vcenter"},"Welcome to my chat application")),o.a.createElement(T.a.Body,null,o.a.createElement(h.a,{onSubmit:function(e){return f(e)}},o.a.createElement(h.a.Row,null,o.a.createElement(_.a,{md:7},o.a.createElement(h.a.Label,null,"Choose nametag"),o.a.createElement(h.a.Control,{type:"text",placeholder:"Enter tag",onChange:function(e){return function(e){c(e.target.value)}(e)}}),o.a.createElement(h.a.Text,{className:"text-muted"},"Tag must be unique")),o.a.createElement(h.a.Group,{as:_.a,md:3,controlId:"colorChoiceForm"},o.a.createElement(h.a.Label,null,"Current colour"),o.a.createElement(R.a,{style:{backgroundColor:i,borderColor:i},onClick:function(e){g(m())}},"Randomize"))),o.a.createElement(h.a.Row,{style:{paddingTop:"10px"}},o.a.createElement(_.a,null,o.a.createElement(R.a,{onClick:function(e){f(e)}},"Choose tag")))),o.a.createElement(j.a,{variant:"warning",show:n.showAlert,style:{marginTop:10}},n.alertText)))})),k=Object(i.b)((function(e){return{users:e.userListReducer}}))((function(e){return o.a.createElement("div",null,"Users connected: ",Object.keys(e.users).length,o.a.createElement("ul",null,Object.keys(e.users).map((function(e){return o.a.createElement("div",{key:e},e)}))))})),G=n(113),I=n(114),x=function(){return o.a.createElement("div",{className:"mainChat"},o.a.createElement(G.a,{style:{marginLeft:0,marginRight:0}},o.a.createElement(C,null),o.a.createElement(I.a,{style:{marginLeft:0,marginRight:0}},o.a.createElement(_.a,{style:{marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0}},o.a.createElement(O,null)),o.a.createElement(_.a,null,o.a.createElement(k,null))),o.a.createElement(I.a,null,o.a.createElement(_.a,null,o.a.createElement(b,null)),o.a.createElement(_.a,null))))};function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={};switch(t.type){case"SET_USER_LIST":return t.value;case"ADD_USER_TO_LIST":return console.log("action value",t.value),(n=H({},e))[t.value.user]=t.value,console.log("state:",n),n;case"REMOVE_USER_FROM_LIST":return console.log("action value",t.value),delete(n=H({},e))[t.value.user],console.log("state:",n),n;default:return e}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOCKET":return t.value;default:return e}},F=n(30);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z={setSocket:function(e){return{type:"SET_SOCKET",value:e}},setUser:function(e){return{type:"SET_USER",value:e}},addMessageToLog:d,setShowAlert:N,setShowLogin:function(e){return{type:"SET_SHOW_LOGIN",value:e}},setUserList:function(e){return console.log("value:",e),{type:"SET_USER_LIST",value:e}},addUserToList:function(e){return{type:"ADD_USER_TO_LIST",value:e}},removeUserFromList:function(e){return{type:"REMOVE_USER_FROM_LIST",value:e}}},q=Object(i.b)(null,z)((function(e){var t=e.setSocket,n=e.addMessageToLog,r=e.setShowAlert,a=e.setUser,c=e.setShowLogin,l=e.setUserList,s=e.addUserToList,i=e.removeUserFromList,E=u()(F.PORT);return E.on("popup",(function(e){console.log("hello: ",e)})),E.on("connection",(function(){console.log("client connected")})),E.on("connect_error",(function(e){console.log("client connect_error: ",e)})),E.on("connect_timeout",(function(e){console.log("client connect_timeout: ",e)})),console.log("socket:",E),console.log("WSPORT:",F.WSPORT),console.log("PORT:",F.PORT),E.on("BROADCAST_MESSAGE",(function(e){n(e)})),E.on("USER_TAKEN",(function(e){n(e)})),E.on("USERNAME_ACCEPTED",(function(e){console.log("user:",e),a({name:e.user,color:e.color}),c(!1),n(J({},e,{content:"Joined the chat!",type:"AUTOMATED_MESSAGE"})),s(e)})),E.on("USERNAME_TAKEN",(function(){r(!0,"Name already in use"),console.log("username taken")})),E.on("NEW_USER_CONNECTED",(function(e){console.log("new user connected:",e),s(e),n(J({},e,{content:"Joined the chat!",type:"AUTOMATED_MESSAGE"}))})),E.on("ACTIVE_USERS_ON_CONNECTION",(function(e){l(e)})),E.on("USER_DISCONNECTED",(function(e){console.log("disconnected user:",e),n(J({},e,{content:"Has left the chat!",type:"AUTOMATED_MESSAGE"})),i(e)})),t(E),o.a.createElement(x,null)})),Q=n(18),X=n(62),Y=Object(Q.c)({messageLogReducer:S,messageReducer:p,socketReducer:V,userReducer:A,loginReducer:U,userListReducer:B}),Z=Object(Q.d)(Y,Object(Q.a)(X.a));n(107),n(108);c.a.render(o.a.createElement(i.a,{store:Z},o.a.createElement(q,null)),document.getElementById("root"))},30:function(e,t,n){var r=Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_HTTP_PORT:"http://localhost:4001/"}).REACT_APP_WEBSOCKET_PORT,o="http://localhost:4001/";o=Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_HTTP_PORT:"http://localhost:4001/"}).PORT,e.exports={WSPORT:r,PORT:o}},65:function(e,t,n){e.exports=n(109)},98:function(e,t){}},[[65,1,2]]]);
//# sourceMappingURL=main.ac94235d.chunk.js.map